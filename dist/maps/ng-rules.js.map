{"version":3,"sources":["ng-rules.js"],"names":["modules","__webpack_require__","moduleId","installedModules","exports","module","id","loaded","call","m","c","p","_interopRequireDefault","obj","__esModule","default","RulesService","$timeout","watchItems","_loop","watchExpressionList","rItems","rules","angular","isDefined","originName","isArray","source","forEach","item","index","propPath","push","watchFunction","_watchHandle","watchHandle","undefined","watchFn","$scope","$watch","watchContent","customRules","result","timeChecker","watchList","cancelWatchItems","clear","setRule","ruleName","method","getInitResult","$watchCollection","val","extend","$invalid","$setRule","originRules","copy","_regexCollection2","arguments","length","$eval","_analyzeOriginRules2","$inject","Object","defineProperty","value","_regexCollection","_analyzeOriginRules","factory","required","isUndefined","test","number","email","maxLen","len","str","String","rps_value","replace","eq","orginVal","compareVal","equals","gt","val1","val2","analyzeOriginRules","analyzeScope","newRules","ruleStr","np","updateRule","sp","split","rItem","i","rsp","methodName","splice","isReverse","map","type","_enumType","ParamType","VALUE","PROPERTY","indexOf","substr","params","fieldName","rItemList","prop","hasAnotherField","fields","getWatchFields","funcStr","join","Function","watchItem","path","createProp","ri","param","concat","paramsStr","newValue","cancel","checkValid","findIndex","values","filter","propStr","propVal","node","spName","exec","arrayItem","_p","Array","prototype","predicate","this","TypeError","list","thisArg"],"mappings":"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","file":"ng-rules.js","sourceRoot":"/source/","sourcesContent":["/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n\n\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\n\tRulesService.$inject = [\"$timeout\"];\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\n\tvar _regexCollection = __webpack_require__(1);\n\n\tvar _regexCollection2 = _interopRequireDefault(_regexCollection);\n\n\tvar _analyzeOriginRules = __webpack_require__(2);\n\n\tvar _analyzeOriginRules2 = _interopRequireDefault(_analyzeOriginRules);\n\n\tvar _watchHandle = __webpack_require__(4);\n\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n\tangular.module('ngRules', []).factory('$rules', RulesService);\n\t//import {ParamType} from './enum-type';\n\n\n\tfunction RulesService($timeout) {\n\t    'ngInject';\n\n\t    return function ruleFn() {\n\t        var $scope = void 0,\n\t            originName = void 0,\n\t            rules = void 0,\n\t            originRules = void 0,\n\t            timeChecker = void 0,\n\t            source = void 0,\n\t            result = void 0,\n\t            customRules = angular.copy(_regexCollection2.default);\n\n\t        //handle dynamic arguments\n\t        if (arguments.length === 2) {\n\t            $scope = arguments[0];\n\t            originRules = arguments[1];\n\t            source = $scope;\n\t        } else {\n\t            $scope = arguments[0];\n\t            originName = arguments[1];\n\t            originRules = arguments[2];\n\t            source = $scope.$eval(originName);\n\t        }\n\n\t        result = getInitResult();\n\n\t        rules = (0, _analyzeOriginRules2.default)(originRules, $scope, originName);\n\n\t        var watchList = [];\n\n\t        watchItems();\n\n\t        return result;\n\n\t        function watchItems() {\n\t            var _loop = function _loop(p) {\n\t                var watchExpressionList = [],\n\t                    rItems = rules[p];\n\n\t                if (angular.isDefined(originName) && angular.isArray(source)) {\n\t                    source.forEach(function (item, index) {\n\t                        var propPath = '.' + originName + '[' + index + ']';\n\t                        watchExpressionList.push({\n\t                            watchFunction: (0, _watchHandle.watchHandle)(rItems, propPath),\n\t                            index: index,\n\t                            item: item\n\t                        });\n\t                    });\n\t                } else {\n\t                    var propPath = angular.isDefined(originName) ? '.' + originName : '';\n\t                    watchExpressionList = [{\n\t                        watchFunction: (0, _watchHandle.watchHandle)(rItems, propPath),\n\t                        index: undefined,\n\t                        item: source\n\t                    }];\n\t                }\n\n\t                watchExpressionList.forEach(function (item) {\n\t                    var watchFn = $scope.$watch(item.watchFunction, (0, _watchHandle.watchContent)(rItems, item, p, customRules, result, timeChecker, $timeout));\n\t                    watchList.push(watchFn);\n\t                });\n\t            };\n\n\t            for (var p in rules) {\n\t                _loop(p);\n\t            }\n\t        }\n\n\t        function cancelWatchItems() {\n\t            watchList.forEach(function (clear) {\n\t                clear();\n\t            });\n\n\t            watchList = [];\n\t        }\n\n\t        function setRule(ruleName, method) {\n\t            customRules[ruleName] = method;\n\t        }\n\n\t        function getInitResult() {\n\t            var result = void 0;\n\n\t            if (angular.isDefined(originName) && angular.isArray(source)) {\n\t                result = [];\n\t                $scope.$watchCollection(originName, function (val) {\n\t                    if (angular.isDefined(val)) {\n\t                        cancelWatchItems();\n\t                        watchItems();\n\t                    }\n\t                });\n\t            } else {\n\t                result = {};\n\t            }\n\n\t            angular.extend(result, {\n\t                $invalid: false,\n\t                $setRule: setRule\n\t            });\n\n\t            return result;\n\t        }\n\t    };\n\t}\n\n\texports.default = RulesService;\n\n/***/ },\n/* 1 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\texports.default = {\n\t    'required': function required(value) {\n\t        return !(angular.isUndefined(value) || value === null || /^\\s*$/.test(value));\n\t    },\n\t    'number': function number(value) {\n\t        return (/^-?\\d+(?:\\.\\d+)?$/.test(value)\n\t        );\n\t    },\n\t    'email': function email(value) {\n\t        return (/^(\\w+|\\.+)((-\\w+|\\.+)|(\\.+\\w+))*\\@\\w+((\\.|-)\\w+)*\\.\\w+/.test(value)\n\t        );\n\t    },\n\t    'maxLen': function maxLen(value, len) {\n\t        var str = String(value),\n\t            rps_value = str.replace(/^\\s+|\\s+$/g, '');\n\t        return rps_value.length <= len;\n\t    },\n\t    'eq': function eq(orginVal, compareVal) {\n\t        return angular.equals(orginVal, compareVal);\n\t    },\n\t    'gt': function gt(val1, val2) {\n\t        return val1 > val2;\n\t    }\n\t};\n\n/***/ },\n/* 2 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\n\tvar _enumType = __webpack_require__(3);\n\n\tfunction analyzeOriginRules(originRules, $scope, originName) {\n\t    var analyzeScope = void 0,\n\t        newRules = {};\n\n\t    if (originName) {\n\t        analyzeScope = $scope.$eval(originName);\n\t        if (angular.isArray(analyzeScope)) {\n\t            analyzeScope = analyzeScope[0];\n\t        }\n\t    } else {\n\t        analyzeScope = $scope;\n\t    }\n\n\t    for (var p in originRules) {\n\t        var ruleStr = originRules[p];\n\n\t        if (p === '*') {\n\t            for (var np in analyzeScope) {\n\t                updateRule(newRules, np, ruleStr);\n\t            }\n\t        } else {\n\t            updateRule(newRules, p, ruleStr);\n\t        }\n\t    }\n\n\t    return newRules;\n\t}\n\n\tfunction updateRule(rules, p, ruleStr) {\n\t    var sp = ruleStr.split(/\\s*\\|\\s*/);\n\n\t    if (angular.isUndefined(rules[p])) {\n\t        rules[p] = [];\n\t    }\n\n\t    var rItem = rules[p];\n\n\t    for (var i = 0, len = sp.length; i < len; i++) {\n\t        var rsp = sp[i].split(/\\s*:\\s*/),\n\t            methodName = rsp.splice(0, 1)[0].replace(/^\\s+|\\s+$/g, ''),\n\t            isReverse = false;\n\n\t        if (rsp.length > 0) {\n\t            rsp = rsp.map(function (item) {\n\t                var type = void 0;\n\n\t                if (/^\\s*['\"]|['\"]\\s*$/.test(item) || /^-?\\d+(?:\\.\\d+)?$/.test(item)) {\n\t                    type = _enumType.ParamType.VALUE;\n\t                } else {\n\t                    type = _enumType.ParamType.PROPERTY;\n\t                }\n\n\t                return {\n\t                    type: type,\n\t                    value: item.replace(/^\\s+|\\s+$/g, '').replace(/^['\"]|['\"]$/g, '')\n\t                };\n\t            });\n\t        }\n\n\t        if (methodName.indexOf('!') !== -1) {\n\t            isReverse = true;\n\t            methodName = methodName.substr(1);\n\t        }\n\n\t        rItem.push({\n\t            methodName: methodName,\n\t            params: rsp,\n\t            isReverse: isReverse\n\t        });\n\t    }\n\n\t    rItem.fieldName = p;\n\t}\n\n\texports.default = analyzeOriginRules;\n\n/***/ },\n/* 3 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\n\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\tvar ParamType = exports.ParamType = {\n\t    PROPERTY: 1,\n\t    VALUE: 2\n\t};\n\n/***/ },\n/* 4 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\texports.watchHandle = watchHandle;\n\texports.watchContent = watchContent;\n\n\t__webpack_require__(5);\n\n\tvar _enumType = __webpack_require__(3);\n\n\tfunction watchHandle(rItemList, prop) {\n\t    //if it has specify another field as parameter, then we need check combo\n\t    if (hasAnotherField(rItemList)) {\n\t        var fields = getWatchFields(rItemList);\n\n\t        var funcStr = fields.map(function (item) {\n\t            return '(angular.isObject($scope' + prop + '.' + item + ')? JSON.stringify($scope' + prop + '.' + item + ') : $scope' + prop + '.' + item + ')';\n\t        }).join('+');\n\n\t        return new Function('$scope', '\\n            return ' + funcStr + ';\\n        ');\n\t    } else {\n\t        return new Function('$scope', '\\n            return $scope' + prop + '.' + rItemList.fieldName + ';\\n        ');\n\t    }\n\t}\n\n\tfunction watchContent(rItems, watchItem, p, customRules, result, timeChecker, $timeout) {\n\t    var path = angular.isDefined(watchItem.index) ? '[' + watchItem.index + '].' + p : '.' + p;\n\n\t    createProp(result, path.replace(/^\\./, ''), { $invalid: false });\n\n\t    var funcStr = ['\\n        var itemResult;\\n    '];\n\n\t    for (var i = 0, len = rItems.length; i < len; i++) {\n\t        var ri = rItems[i];\n\n\t        var params = ri.params.map(function (param) {\n\t            if (param.type === _enumType.ParamType.PROPERTY) {\n\t                return 'layerItem.' + param.value;\n\t            } else {\n\t                return '\\'' + param.value + '\\'';\n\t            }\n\t        });\n\n\t        params = ['layerItem.' + p].concat(params);\n\n\t        var paramsStr = params.join(','),\n\t            isReverse = ri.isReverse ? '!' : '';\n\n\t        funcStr.push('\\n            itemResult = ' + isReverse + 'customRules.' + ri.methodName + '(' + paramsStr + ');\\n            \\n            result' + path + '.$invalid = !itemResult;\\n            \\n            if(!itemResult){\\n                checkResult();\\n                return;\\n            }\\n        ');\n\t    }\n\n\t    funcStr.push('\\n        checkResult();\\n    ');\n\n\t    var watchFn = new Function('result', 'layerItem', 'customRules', 'checkResult', funcStr.join(''));\n\n\t    return function (newValue) {\n\t        if (angular.isUndefined(newValue)) {\n\t            return;\n\t        }\n\n\t        watchFn(result, watchItem.item, customRules, function () {\n\t            timeChecker && $timeout.cancel(timeChecker);\n\n\t            timeChecker = $timeout(function () {\n\t                checkValid(result);\n\t            }, 60);\n\t        });\n\t    };\n\t}\n\n\tfunction hasAnotherField(rItemList) {\n\t    for (var i = 0, len = rItemList.length; i < len; i++) {\n\t        var rItem = rItemList[i];\n\n\t        if (angular.isDefined(rItem.params) && rItem.params.findIndex(function (item) {\n\t            return item.type === _enumType.ParamType.PROPERTY;\n\t        }) !== -1) {\n\t            return true;\n\t        }\n\t    }\n\t    return false;\n\t}\n\n\tfunction getWatchFields(rItemList) {\n\t    var fields = [rItemList.fieldName],\n\t        result = [];\n\n\t    for (var i = 0, len = rItemList.length; i < len; i++) {\n\t        var rItem = rItemList[i];\n\n\t        var values = rItem.params.filter(function (item) {\n\t            return item.type === _enumType.ParamType.PROPERTY;\n\t        }).map(function (item) {\n\t            return item.value;\n\t        });\n\n\t        fields = fields.concat(values);\n\t    }\n\n\t    fields.forEach(function (item) {\n\t        if (result.indexOf(item) === -1) {\n\t            result.push(item);\n\t        }\n\t    });\n\n\t    return result;\n\t}\n\n\tfunction createProp(obj, propStr, propVal) {\n\t    var sp = propStr.split('.');\n\t    var node = obj;\n\n\t    for (var i = 0, len = sp.length; i < len; i++) {\n\t        var spName = sp[i];\n\n\t        if (spName.indexOf('[') !== -1) {\n\t            spName = /[^\\[\\]]+/.exec(spName)[0];\n\t        }\n\n\t        if (angular.isUndefined(node[spName])) {\n\t            node[spName] = {};\n\t        }\n\n\t        if (i === len - 1) {\n\t            node[spName] = propVal;\n\t        } else {\n\t            node = node[spName];\n\t        }\n\t    }\n\t}\n\n\tfunction checkValid(obj) {\n\n\t    if (angular.isArray(obj)) {\n\t        for (var i = 0, len = obj.length; i < len; i++) {\n\t            var arrayItem = obj[i];\n\t            for (var _p in arrayItem) {\n\t                if (!/^$/.test(_p) && arrayItem[_p].$invalid) {\n\t                    obj.$invalid = true;\n\t                    return;\n\t                }\n\t            }\n\t        }\n\t    } else {\n\t        for (var p in obj) {\n\t            if (!/^$/.test(p) && obj[p].$invalid) {\n\t                obj.$invalid = true;\n\t                return;\n\t            }\n\t        }\n\t    }\n\n\t    obj.$invalid = false;\n\t}\n\n/***/ },\n/* 5 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\n\tif (!Array.prototype.findIndex) {\n\t    Array.prototype.findIndex = function (predicate) {\n\t        if (this === null) {\n\t            throw new TypeError('Array.prototype.findIndex called on null or undefined');\n\t        }\n\t        if (typeof predicate !== 'function') {\n\t            throw new TypeError('predicate must be a function');\n\t        }\n\t        var list = Object(this);\n\t        var length = list.length >>> 0;\n\t        var thisArg = arguments[1];\n\t        var value;\n\n\t        for (var i = 0; i < length; i++) {\n\t            value = list[i];\n\t            if (predicate.call(thisArg, value, i, list)) {\n\t                return i;\n\t            }\n\t        }\n\t        return -1;\n\t    };\n\t}\n\n/***/ }\n/******/ ]);"]}